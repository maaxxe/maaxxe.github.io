<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <title>Mon Calendrier Interactif</title>
    <style>
        body {
            font-family: 'Segoe UI', sans-serif;
            background: #f0f2f5;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
        }

        .header {
            background: white;
            padding: 15px 25px;
            border-radius: 12px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
            display: flex;
            gap: 10px;
            align-items: center;
        }

        select,
        button {
            padding: 10px;
            border-radius: 6px;
            border: 1px solid #ddd;
            font-size: 1rem;
            cursor: pointer;
        }

        button {
            background: #333;
            color: white;
            border: none;
            font-weight: bold;
            width: 45px;
        }

        button:hover {
            background: #555;
        }

        #calendar-container {
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.1);
            width: 95%;
            max-width: 1100px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            table-layout: fixed;
        }

        th {
            background: #f8f9fa;
            padding: 12px;
            border: 1px solid #eee;
            color: #666;
            font-size: 0.85rem;
            text-transform: uppercase;
        }

        td {
            border: 1px solid #ddd;
            height: 130px;
            vertical-align: top;
            padding: 8px;
            transition: 0.2s;
            position: relative;
        }

        .date-num {
            font-weight: bold;
            color: #444;
            margin-bottom: 8px;
        }

        .event {
            font-size: 0.75rem;
            padding: 4px 8px;
            margin-bottom: 4px;
            border-radius: 4px;
            border-left: 4px solid rgba(0, 0, 0, 0.2);
            font-weight: 500;
            color: #333;
        }

        .today {
            background: #fffde7 !important;
            border: 2px solid #ffd600 !important;
        }
    </style>
</head>
<div id="customModal"
    style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.5); z-index:1000;">
    <div
        style="background:white; width:300px; margin:15% auto; padding:20px; border-radius:12px; box-shadow:0 5px 15px rgba(0,0,0,0.3); text-align:center;">
        <h3 id="modalTitle" style="margin-top:0; color:#333;"></h3>
        <p id="modalNote" style="color:#666; line-height:1.5;"></p>
        <button onclick="closeNote()"
            style="background:#333; color:white; border:none; padding:10px 20px; border-radius:6px; cursor:pointer; width:100%;">OK</button>
    </div>
</div>

<body>

    <div class="header">
        <button onclick="changeMonth(-1)">«</button>
        <select id="monthSelect" onchange="renderCalendar()"></select>
        <select id="yearSelect" onchange="renderCalendar()"></select>
        <button onclick="changeMonth(1)">»</button>
    </div>

    <div id="calendar-container">
        <h2 id="monthTitle" style="text-align: center; margin-top: 0;"></h2>
        <table>
            <thead>
                <tr>
                    <th>Lun</th>
                    <th>Mar</th>
                    <th>Mer</th>
                    <th>Jeu</th>
                    <th>Ven</th>
                    <th>Sam</th>
                    <th>Dim</th>
                </tr>
            </thead>
            <tbody id="calendarBody"></tbody>
        </table>
    </div>

    <script>
        const evenements = {"17/02/2026": [{"texte": "Faire TP1 en scieence", "commentaire": "attention assez dur", "couleur": "#ffcccc"}], "17/03/2026": [{"texte": "Aller chez le dentiste", "commentaire": "", "couleur": "#ffe5b4"}], "19/02/2026": [{"texte": "Aller chez le dentiste", "commentaire": "", "couleur": "#ffe5b4"}], "22/03/2026": [{"texte": "Anniversaire de papa", "commentaire": "", "couleur": "#d1e9ff"}], "16/02/2026": [{"texte": "Aller chez le dentiste", "commentaire": "", "couleur": "#ffd1dc"}]};
        const months = ["Janvier", "Février", "Mars", "Avril", "Mai", "Juin", "Juillet", "Août", "Septembre", "Octobre", "Novembre", "Décembre"];

        const monthSelect = document.getElementById('monthSelect');
        const yearSelect = document.getElementById('yearSelect');

        months.forEach((m, i) => monthSelect.add(new Option(m, i)));
        for (let i = 2024; i <= 2030; i++) yearSelect.add(new Option(i, i));

        let now = new Date();
        monthSelect.value = now.getMonth();
        yearSelect.value = now.getFullYear();

        function changeMonth(step) {
            let m = parseInt(monthSelect.value) + step;
            let y = parseInt(yearSelect.value);
            if (m > 11) { m = 0; y++; }
            else if (m < 0) { m = 11; y--; }
            monthSelect.value = m;
            yearSelect.value = y;
            renderCalendar();
        }

        function showNote(titre, note) {
            document.getElementById('modalTitle').innerText = titre;
            document.getElementById('modalNote').innerText = (note && note !== "undefined") ? note : "Aucun commentaire.";
            document.getElementById('customModal').style.display = 'block';
        }

        function closeNote() {
            document.getElementById('customModal').style.display = 'none';
        }

        function renderCalendar() {
            const month = parseInt(monthSelect.value);
            const year = parseInt(yearSelect.value);
            const body = document.getElementById('calendarBody');

            let firstDay = new Date(year, month, 1).getDay();
            let startingDay = (firstDay === 0) ? 6 : firstDay - 1;
            let daysInMonth = new Date(year, month + 1, 0).getDate();

            body.innerHTML = '';
            document.getElementById('monthTitle').innerText = months[month] + " " + year;

            let date = 1;
            for (let i = 0; i < 6; i++) {
                let row = document.createElement('tr');
                let hasData = false;
                for (let j = 0; j < 7; j++) {
                    let cell = document.createElement('td');
                    if ((i === 0 && j < startingDay) || date > daysInMonth) {
                        cell.innerHTML = "";
                    } else {
                        hasData = true;
                        let dateKey = String(date).padStart(2, '0') + "/" + String(month + 1).padStart(2, '0') + "/" + year;

                        if (date === now.getDate() && month === now.getMonth() && year === now.getFullYear()) {
                            cell.className = 'today';
                        }

                        let html = `<div class="date-num">${date}</div>`;
                        if (evenements[dateKey]) {
                            evenements[dateKey].forEach(ev => {
                                // Nettoyage des textes pour éviter les erreurs de guillemets
                                const t = ev.texte ? ev.texte.replace(/'/g, "\\'") : "";
                                const c = ev.commentaire ? ev.commentaire.replace(/'/g, "\\'") : "";

                                html += `<div class="event" 
                                              onclick="event.stopPropagation(); showNote('${t}', '${c}')" 
                                              style="background-color:${ev.couleur}; cursor:pointer;">
                                            ${ev.texte}
                                         </div>`;
                            });
                        }
                        cell.innerHTML = html;
                        date++;
                    }
                    row.appendChild(cell);
                }
                if (hasData) body.appendChild(row);
                if (date > daysInMonth) break;
            }
        }
        renderCalendar();
    </script>
</body>

</html>