<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Compteur GitHub</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: linear-gradient(135deg, #2d7c4e 0%, #3fa561 100%);
            margin: 0;
        }
        .container {
            background: white;
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            text-align: center;
            max-width: 500px;
        }
        .counter {
            font-size: 4rem;
            font-weight: bold;
            color: #2d7c4e;
            margin: 20px 0;
        }
        button {
            padding: 15px 30px;
            font-size: 1.2rem;
            background: #2d7c4e;
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: 0.3s;
            margin: 5px;
        }
        button:hover {
            background: #1f5a37;
            transform: translateY(-2px);
        }
        .info {
            margin-top: 20px;
            padding: 15px;
            background: #f0f0f0;
            border-radius: 10px;
            text-align: left;
        }
        .info p {
            margin: 8px 0;
            color: #333;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1> Compteur de Clics</h1>
        <div class="counter" id="counter">0</div>
        <button onclick="trackClick()">üëÜ Cliquez-moi!</button>
        
        <div class="info">
            <p> Clics totaux: <strong id="total">0</strong></p>
            <p> IP: <strong id="ip">...</strong></p>
            <p> Lieu: <strong id="location">...</strong></p>
            <p> Appareil: <strong id="device">...</strong></p>
        </div>
        
        <button onclick="downloadData()"> T√©l√©charger donn√©es</button>
        <button onclick="viewData()" style="background: #5ec986;">üëÅÔ∏è Voir donn√©es</button>
    </div>

    <script>
        let sessionData = {
            clicks: [],
            sessionStart: new Date().toISOString(),
            totalClicks: 0
        };

        // Charger les donn√©es initiales
        loadInitialData();

        async function loadInitialData() {
            // Obtenir IP et localisation
            try {
                const ipRes = await fetch('https://api.ipify.org?format=json');
                const ipData = await ipRes.json();
                document.getElementById('ip').textContent = ipData.ip;
                
                const locRes = await fetch(`https://ipapi.co/${ipData.ip}/json/`);
                const locData = await locRes.json();
                document.getElementById('location').textContent = 
                    `${locData.city}, ${locData.country_name}`;
                
                sessionData.ip = ipData.ip;
                sessionData.location = `${locData.city}, ${locData.country_name}`;
            } catch (error) {
                console.error('Erreur IP:', error);
            }

            // D√©tecter l'appareil
            const ua = navigator.userAgent;
            let device = 'Desktop';
            if (/mobile/i.test(ua)) device = 'Mobile';
            if (/tablet/i.test(ua)) device = 'Tablet';
            document.getElementById('device').textContent = device;
            sessionData.device = device;

            // Charger depuis localStorage
            const saved = localStorage.getItem('clickData');
            if (saved) {
                sessionData = JSON.parse(saved);
                updateDisplay();
            }
        }

        async function trackClick() {
            sessionData.totalClicks++;
            
            const clickInfo = {
                id: sessionData.totalClicks,
                timestamp: new Date().toISOString(),
                ip: sessionData.ip || 'unknown',
                location: sessionData.location || 'unknown',
                device: sessionData.device || 'unknown',
                browser: getBrowser(),
                screen: `${window.screen.width}x${window.screen.height}`
            };
            
            sessionData.clicks.push(clickInfo);
            
            // Sauvegarder localement
            localStorage.setItem('clickData', JSON.stringify(sessionData));
            
            // Envoyer √† un service externe (optionnel)
            sendToWebhook(clickInfo);
            
            updateDisplay();
            animateCounter();
        }

        function updateDisplay() {
            document.getElementById('counter').textContent = sessionData.totalClicks;
            document.getElementById('total').textContent = sessionData.totalClicks;
        }

        function animateCounter() {
            const counter = document.getElementById('counter');
            counter.style.transform = 'scale(1.3)';
            counter.style.color = '#5ec986';
            setTimeout(() => {
                counter.style.transform = 'scale(1)';
                counter.style.color = '#2d7c4e';
            }, 300);
        }

        function getBrowser() {
            const ua = navigator.userAgent;
            if (ua.includes('Firefox')) return 'Firefox';
            if (ua.includes('Chrome')) return 'Chrome';
            if (ua.includes('Safari')) return 'Safari';
            if (ua.includes('Edge')) return 'Edge';
            return 'Unknown';
        }

        // Envoyer √† un webhook (Discord, Slack, etc.)
        async function sendToWebhook(data) {
            // REMPLACE CETTE URL par ton webhook Discord/Slack
            const webhookURL = 'YOUR_WEBHOOK_URL_HERE';
            
            try {
                await fetch(webhookURL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        content: ` Nouveau clic #${data.id}`,
                        embeds: [{
                            title: 'D√©tails du clic',
                            color: 3066993,
                            fields: [
                                { name: 'IP', value: data.ip, inline: true },
                                { name: 'Lieu', value: data.location, inline: true },
                                { name: 'Appareil', value: data.device, inline: true },
                                { name: 'Navigateur', value: data.browser, inline: true },
                                { name: 'Heure', value: new Date(data.timestamp).toLocaleString('fr-FR') }
                            ]
                        }]
                    })
                });
            } catch (error) {
                console.log('Webhook non configur√©');
            }
        }

        function downloadData() {
            const dataStr = JSON.stringify(sessionData, null, 2);
            const blob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `clicks_${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            URL.revokeObjectURL(url);
        }

        function viewData() {
            const dataWindow = window.open('', '_blank', 'width=800,height=600');
            dataWindow.document.write(`
                <html>
                <head>
                    <title>Donn√©es de clics</title>
                    <style>
                        body { font-family: monospace; padding: 20px; background: #1e1e1e; color: #d4d4d4; }
                        pre { background: #2d2d2d; padding: 20px; border-radius: 10px; overflow: auto; }
                    </style>
                </head>
                <body>
                    <h2> Donn√©es des clics</h2>
                    <pre>${JSON.stringify(sessionData, null, 2)}</pre>
                </body>
                </html>
            `);
        }
    </script>
</body>
</html>
